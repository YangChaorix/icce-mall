{"ast":null,"code":"import API from \"../../../utils/request\";\nimport icons from \"@/utils/icons\";\nexport default {\n  name: \"Category\",\n  data() {\n    return {\n      options: [],\n      searchText: \"\",\n      user: {},\n      //从icons.js中引入常量iconStore\n      iconStore: icons.iconStore,\n      icons: [],\n      icon: {},\n      addIcon: {},\n      pageNum: 1,\n      pageSize: 5,\n      entity: {},\n      total: 0,\n      dialogFormVisible: false,\n      addDialogFormVisible: false\n    };\n  },\n  created() {\n    this.user = localStorage.getItem(\"user\") ? JSON.parse(sessionStorage.getItem(\"user\")) : {};\n    this.load();\n    console.log(this.iconStore);\n  },\n  methods: {\n    load() {\n      this.request.get(\"/api/icon\").then(res => {\n        this.icons = res.data;\n      });\n    },\n    handleEditCategory(category) {\n      this.$prompt(\"请输入修改后的名称\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\"\n      }).then(({\n        value\n      }) => {\n        if (value == null || value == undefined || value.trim() == \"\") {\n          this.$message.error(\"请输入名称\");\n          return;\n        }\n        category.name = value;\n        this.request.post(\"/api/category\", category).then(res => {\n          if (res.code === \"200\") {\n            this.$message.success(\"修改成功\");\n          } else {\n            this.$message.error(\"修改失败\");\n          }\n        });\n      }).catch(() => {});\n    },\n    handleAddCategory(icon) {\n      this.$prompt(\"请输入新增的下级分类名称\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\"\n      }).then(({\n        value\n      }) => {\n        if (value == null || value == undefined || value.trim() == \"\") {\n          this.$message.error(\"请输入名称\");\n          return;\n        }\n        this.request.post(\"/api/category/add\", {\n          name: value,\n          iconId: icon.id\n        }).then(res => {\n          if (res.code === \"200\") {\n            this.$message.success(\"新增成功\");\n            this.load();\n          } else {\n            this.$message.error(\"新增失败\");\n          }\n        });\n      }).catch(() => {});\n    },\n    handleEditIcon(icon) {\n      this.icon = JSON.parse(JSON.stringify(icon));\n      this.dialogFormVisible = true;\n    },\n    editIcon() {\n      //删除无用的属性\n      delete this.icon.categories;\n      this.request.post(\"/api/icon\", this.icon).then(res => {\n        if (res.code === \"200\") {\n          this.$message.success(\"修改成功\");\n          this.dialogFormVisible = false;\n        } else {\n          this.$message.error(\"修改失败\");\n        }\n      });\n    },\n    saveIcon() {\n      // 新增上级分类\n      if (this.addIcon.value == undefined) {\n        this.$message.error(\"请选择上级分类图标\");\n        return;\n      }\n      this.request.post(\"/api/icon\", this.addIcon).then(res => {\n        console.log(res);\n        if (res.code === \"200\") {\n          this.$message.success(\"新增成功\");\n          this.addDialogFormVisible = false;\n          this.load();\n        } else {\n          this.$message.error(\"新增失败\");\n        }\n      });\n    },\n    deleteIcon(iconId) {\n      // 删除上级分类\n      this.request.get(\"/api/icon/delete?id=\" + iconId).then(res => {\n        if (res.code == \"200\") {\n          this.$message.success(\"删除成功\");\n          this.load();\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    deleteCategory(category) {\n      // 删除下级分类\n      this.request.get(\"/api/category/delete?id=\" + category.id).then(res => {\n        if (res.code == \"200\") {\n          this.$message.success(\"删除成功\");\n          this.load();\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["API","icons","name","data","options","searchText","user","iconStore","icon","addIcon","pageNum","pageSize","entity","total","dialogFormVisible","addDialogFormVisible","created","localStorage","getItem","JSON","parse","sessionStorage","load","console","log","methods","request","get","then","res","handleEditCategory","category","$prompt","confirmButtonText","cancelButtonText","value","undefined","trim","$message","error","post","code","success","catch","handleAddCategory","iconId","id","handleEditIcon","stringify","editIcon","categories","saveIcon","deleteIcon","msg","deleteCategory"],"sources":["src/views/manage/good/Category.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <div style=\"width: 80%; margin: 30px auto\">\r\n      <el-button type=\"success\" icon=\"iconfont icon-r-add\" style=\"font-size: 20px;\"\r\n        @click=\"addDialogFormVisible = true\"> 新增上级分类</el-button>\r\n      <el-table :data=\"icons\" stripe>\r\n        <!-- 下级分类表-->\r\n        <el-table-column type=\"expand\" label=\"下级分类\" width=\"100px\">\r\n          <template slot-scope=\"scope\">\r\n            <el-table :data=\"scope.row.categories\" :header-cell-style=\"{ background: '#cbefea', color: 'black' }\">\r\n              <el-table-column label=\"分类id\" prop=\"id\"></el-table-column>\r\n              <el-table-column label=\"分类名称\" prop=\"name\"></el-table-column>\r\n              <el-table-column label=\"操作\" width=\"260\">\r\n                <template slot-scope=\"scope\">\r\n                  <el-button type=\"primary\" @click=\"handleEditCategory(scope.row)\"> 修改</el-button>\r\n\r\n                  <el-popconfirm @confirm=\"deleteCategory(scope.row)\" title=\"确定删除？\">\r\n                    <el-button type=\"danger\" slot=\"reference\"> 删除</el-button>\r\n                  </el-popconfirm>\r\n                </template>\r\n              </el-table-column>\r\n            </el-table>\r\n          </template>\r\n          <!---->\r\n        </el-table-column>\r\n        <el-table-column label=\"id\" prop=\"id\" width=\"60px\"></el-table-column>\r\n        <el-table-column label=\"icon\">\r\n          <template slot-scope=\"scope\">\r\n            <i class=\"iconfont\" v-html=\"scope.row.value\"></i>\r\n          </template>\r\n        </el-table-column>\r\n\r\n        <el-table-column fixed=\"right\" label=\"操作\" width=\"380\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button type=\"primary\" @click=\"handleEditIcon(scope.row)\"> 编辑</el-button>\r\n            <el-button type=\"success\" @click=\"handleAddCategory(scope.row)\"> 新增</el-button>\r\n\r\n            <el-popconfirm @confirm=\"deleteIcon(scope.row.id)\" title=\"确定删除？\">\r\n              <el-button type=\"danger\" style=\"margin-left: 10px;\" slot=\"reference\"> 删除</el-button>\r\n            </el-popconfirm>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </div>\r\n\r\n    <!--icon修改弹窗-->\r\n    <el-dialog title=\"修改上级分类\" :visible.sync=\"dialogFormVisible\">\r\n      <el-form :model=\"icon\">\r\n        <el-form-item label=\"图标\" label-width=\"100px\">\r\n          <i class=\"iconfont\" v-html=\"icon.value\"></i>\r\n        </el-form-item>\r\n        <el-form-item label=\"更改图标\" label-width=\"100px\">\r\n          <el-select placeholder=\"请选择图标\" v-model=\"icon.value\">\r\n            <el-option v-for=\"item in iconStore\" :value=\"item\" :key=\"item\">\r\n              <i class=\"iconfont\" v-html=\"item\"></i>\r\n            </el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogFormVisible = false\" style=\"font-size: 20px;\"> 取消</el-button>\r\n        <el-button type=\"primary\" @click=\"editIcon\" style=\"font-size: 20px;\"><i class=\"iconfont icon-r-yes\"\r\n            style=\"font-size: 22px;\"></i> 确定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <el-dialog title=\"新增上级分类\" :visible.sync=\"addDialogFormVisible\">\r\n      <el-form :model=\"addIcon\">\r\n        <el-form-item label=\"图标\" label-width=\"100px\">\r\n          <i class=\"iconfont\" v-html=\"addIcon.value\"></i>\r\n        </el-form-item>\r\n        <el-form-item label=\"更改图标\" label-width=\"100px\">\r\n          <el-select placeholder=\"请选择图标\" v-model=\"addIcon.value\">\r\n            <el-option v-for=\"item in iconStore\" :value=\"item\" :key=\"item\">\r\n              <i class=\"iconfont\" v-html=\"item\"></i>\r\n            </el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"addDialogFormVisible = false\" style=\"font-size: 20px;\"> 取消</el-button>\r\n        <el-button type=\"primary\" @click=\"saveIcon\" style=\"font-size: 20px;\"><i class=\"iconfont icon-r-yes\"\r\n            style=\"font-size: 22px;\"></i> 确定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport API from \"../../../utils/request\";\r\nimport icons from \"@/utils/icons\";\r\nexport default {\r\n  name: \"Category\",\r\n  data() {\r\n    return {\r\n      options: [],\r\n      searchText: \"\",\r\n      user: {},\r\n      //从icons.js中引入常量iconStore\r\n      iconStore: icons.iconStore,\r\n      icons: [],\r\n      icon: {},\r\n      addIcon: {},\r\n      pageNum: 1,\r\n      pageSize: 5,\r\n      entity: {},\r\n      total: 0,\r\n      dialogFormVisible: false,\r\n      addDialogFormVisible: false,\r\n    };\r\n  },\r\n  created() {\r\n    this.user = localStorage.getItem(\"user\")\r\n      ? JSON.parse(sessionStorage.getItem(\"user\"))\r\n      : {};\r\n    this.load();\r\n    console.log(this.iconStore);\r\n  },\r\n  methods: {\r\n    load() {\r\n      this.request.get(\"/api/icon\").then((res) => {\r\n        this.icons = res.data;\r\n      });\r\n    },\r\n\r\n    handleEditCategory(category) {\r\n      this.$prompt(\"请输入修改后的名称\", \"提示\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n      }).then(({ value }) => {\r\n        if (value == null || value == undefined || value.trim() == \"\") {\r\n          this.$message.error(\"请输入名称\");\r\n          return\r\n        }\r\n        category.name = value;\r\n        this.request.post(\"/api/category\", category).then((res) => {\r\n          if (res.code === \"200\") {\r\n            this.$message.success(\"修改成功\");\r\n          } else {\r\n            this.$message.error(\"修改失败\");\r\n          }\r\n        });\r\n      }).catch(() => {\r\n\r\n      });\r\n    },\r\n    handleAddCategory(icon) {\r\n      this.$prompt(\"请输入新增的下级分类名称\", \"提示\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n      }).then(({ value }) => {\r\n\r\n        if (value == null || value == undefined || value.trim() == \"\") {\r\n          this.$message.error(\"请输入名称\");\r\n          return\r\n        }\r\n        this.request\r\n          .post(\"/api/category/add\", { name: value, iconId: icon.id })\r\n          .then((res) => {\r\n            if (res.code === \"200\") {\r\n              this.$message.success(\"新增成功\");\r\n              this.load();\r\n            } else {\r\n              this.$message.error(\"新增失败\");\r\n            }\r\n          });\r\n      }).catch(() => {\r\n\r\n      });\r\n    },\r\n    handleEditIcon(icon) {\r\n      this.icon = JSON.parse(JSON.stringify(icon));\r\n      this.dialogFormVisible = true;\r\n    },\r\n    editIcon() {\r\n      //删除无用的属性\r\n      delete this.icon.categories;\r\n      this.request.post(\"/api/icon\", this.icon).then((res) => {\r\n        if (res.code === \"200\") {\r\n          this.$message.success(\"修改成功\");\r\n          this.dialogFormVisible = false;\r\n        } else {\r\n          this.$message.error(\"修改失败\");\r\n        }\r\n      });\r\n    },\r\n    saveIcon() {\r\n      // 新增上级分类\r\n      if (this.addIcon.value == undefined) {\r\n        this.$message.error(\"请选择上级分类图标\");\r\n        return;\r\n      }\r\n      this.request.post(\"/api/icon\", this.addIcon).then((res) => {\r\n        console.log(res);\r\n        if (res.code === \"200\") {\r\n          this.$message.success(\"新增成功\");\r\n          this.addDialogFormVisible = false;\r\n          this.load();\r\n        } else {\r\n          this.$message.error(\"新增失败\");\r\n        }\r\n      });\r\n    },\r\n    deleteIcon(iconId) {\r\n      // 删除上级分类\r\n      this.request.get(\"/api/icon/delete?id=\" + iconId).then((res) => {\r\n        if (res.code == \"200\") {\r\n          this.$message.success(\"删除成功\");\r\n          this.load();\r\n        } else {\r\n          this.$message.error(res.msg);\r\n        }\r\n      });\r\n    },\r\n    deleteCategory(category) {\r\n      // 删除下级分类\r\n      this.request.get(\"/api/category/delete?id=\" + category.id).then((res) => {\r\n        if (res.code == \"200\") {\r\n          this.$message.success(\"删除成功\");\r\n          this.load();\r\n        } else {\r\n          this.$message.error(res.msg);\r\n        }\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n@import \"../../../resource/css/icon.css\";\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}